function playAudioTrack(a,e,s=!1){$("#play").addClass("fa-spinner").addClass("fa-spin").addClass("disabled").removeClass("fa-pause"),$(".each_loop,.each_stem").removeClass("active");var i=document.getElementById("def_audio"),t=document.getElementById("def_audio_source"),d=$(window).width();if(d>767){a&&a.destroy();var l=WaveSurfer.create({container:document.querySelector("#audio-spectrum"),progressColor:"#27282A",barHeight:1,barWidth:2,responsive:!0,audioRate:1,waveColor:"#e0e0e0",hideScrollbar:!0,height:35,normalize:!0});l.load(e),l.on("audioprocess",function(){var a=l.getCurrentTime();$("#time").text(getTime(a))}),l.on("finish",function(){$("#next").trigger("click")}),l.on("ready",function(){finalPreparations(s,l)})}else t.src=e,i.load(),i.oncanplay=function(){finalPreparations(s,i)};return $("#play").unbind("click").click(function(){if($(this).hasClass("disabled"));else if(d>767){var a=l.getDuration();$("#end_time").text(getTime(a)),l.isPlaying()?$("#play").addClass("fa-play").removeClass("fa-pause"):$("#play").removeClass("fa-spinner").removeClass("fa-spin").removeClass("fa-play").addClass("fa-pause"),l.playPause()}else i.duration>0&&(i.paused?(i.play(),$("#play").removeClass("fa-spinner").removeClass("fa-spin").removeClass("fa-play").addClass("fa-pause")):(i.pause(),$("#play").addClass("fa-play").removeClass("fa-pause")))}),$("#mute").unbind("click").click(function(){d>767?(l.toggleMute(),l.getMute()?$("#mute").addClass("fa-volume-off").removeClass("fa-volume-up"):$("#mute").addClass("fa-volume-up").removeClass("fa-volume-off")):i.muted?(i.muted=!1,$("#mute").addClass("fa-volume-up").removeClass("fa-volume-off")):(i.muted=!0,$("#mute").addClass("fa-volume-off").removeClass("fa-volume-up"))}),d>767?l:i}function finalPreparations(a,e){var s=$(window).width();if("undefined"!=typeof mediaInstance&&0!=mediaInstance&&mediaInstance.pause(),void 0!==window.currentAudioElement){var i=window.currentAudioElement;i.find(".play_now").removeClass("instant_hide"),i.find(".loading_smg").addClass("instant_hide"),i.removeClass("audio_loading"),delete window.currentAudioElement,musicHoverSupport()}if($("#play").removeClass("disabled"),a)if(s>767){var t=e.getDuration();$("#end_time").text(getTime(t)),e.isPlaying()?$("#play").addClass("fa-play").removeClass("fa-pause"):$("#play").removeClass("fa-spinner").removeClass("fa-spin").removeClass("fa-play").addClass("fa-pause"),e.playPause()}else e.duration>0&&($("#end_time").text(getTime(e.duration)),e.play(),$("#play").removeClass("fa-spinner").removeClass("fa-spin").removeClass("fa-play").addClass("fa-pause"))}function getTime(a){var e=~~(a/60),s=~~(a%60);return(e<10?"0"+e:e)+":"+(s<10?"0"+s:s)}function updateAndPlayAudioPlayer(a,e,s){var i=a;document.getElementById("def_audio"),document.getElementById("def_audio_source");if(i.find(".play_now").length&&(window.currentAudioElement=a,i.addClass("audio_loading"),i.find(".play_now").addClass("instant_hide"),i.find(".loading_smg").removeClass("instant_hide"),i.find(".summary").unbind("hover mouseenter mouseleave")),i.prev().hasClass("each-music"))var t=i.prev();else t=null;if(i.next().hasClass("each-music"))var d=i.next();else d=null;null!==t?($(".ap_outer #audio-player").attr("data-prevmusicid",t.attr("data-musicid")),$("#back").removeClass("disabled")):($(".ap_outer #audio-player").attr("data-prevmusicid",0),$("#back").addClass("disabled")),null!==d?($(".ap_outer #audio-player").attr("data-nextmusicid",d.attr("data-musicid")),$("#next").removeClass("disabled")):($(".ap_outer #audio-player").attr("data-nextmusicid",0),$("#next").addClass("disabled")),$(".ap_outer #audio-player").attr("data-musicid",i.attr("data-musicid")),$(".ap_outer .ap_track_banner").attr("src","/user-music-thumbnails/"+i.attr("data-thumbnail-player")),$(".ap_outer .ap_track_title").html(i.find(".thismusic_song_name").text()+"<br>"+i.find(".thismusic_user_name").text()),i.find(".music_actions .fav_np").hasClass("active")?$(".ap_outer .track_fav").addClass("active"):$(".ap_outer .track_fav").removeClass("active"),$(".ap_outer").show(),"undefined"!=typeof spectrum?spectrum=playAudioTrack(spectrum,e,s):spectrum=playAudioTrack(null,e,s)}$("document").ready(function(){$("body").delegate(".each_loop","click",function(a){var e=$(this);if(e.parents(".each-music").length)var s=e.parents(".each-music");else s=e.parents(".each-album-music");updateAndPlayAudioPlayer(s,"/user-music-files/loops/"+e.attr("data-musicfile"),!0),e.addClass("active")}),$("body").delegate(".each_stem","click",function(a){var e=$(this);if(e.parents(".each-music").length)var s=e.parents(".each-music");else s=e.parents(".each-album-music");updateAndPlayAudioPlayer(s,"/user-music-files/stems/"+e.attr("data-musicfile"),!0),e.addClass("active")}),$("#back").click(function(){if($(this).hasClass("disabled"));else{var a=$(".ap_outer #audio-player").attr("data-prevmusicid");if($('.each-music[data-musicid="'+a+'"]').length){var e=$('.each-music[data-musicid="'+a+'"]');$(".each-music.active_video_list_chan_tab").length&&$(".each-music.active_video_list_chan_tab").first().find(".add_to_cart_item").slideUp(function(){$(".each-music.active_video_list_chan_tab").first().removeClass("active_video_list_chan_tab")}),updateAndPlayAudioPlayer(e,"/user-music-files/"+e.attr("data-musicfile"),!0)}}}),$("#next").click(function(){if($(this).hasClass("disabled"));else{var a=$(".ap_outer #audio-player").attr("data-nextmusicid");if($('.each-music[data-musicid="'+a+'"]').length){var e=$('.each-music[data-musicid="'+a+'"]');$(".each-music.active_video_list_chan_tab").length&&$(".each-music.active_video_list_chan_tab").first().find(".add_to_cart_item").slideUp(function(){$(".each-music.active_video_list_chan_tab").first().removeClass("active_video_list_chan_tab")}),updateAndPlayAudioPlayer(e,"/user-music-files/"+e.attr("data-musicfile"),!0)}}})});